(()=>{"use strict";var e={548:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Advert=void 0;var n=r(239),i=function(){function e(e,t,r,i,o,s,a,d){var u,c,h,l=this;void 0===o&&(o=!1),void 0===s&&(s="bottom"),void 0===a&&(a=!1),this.unit=e,this.id=t,this.sizes=r,this.bids=i,this.refresh=o,this.position=s,this.closeBtn=a,this.refreshSettings=d,this.refreshCounter=0,this.close=function(){var e;l.adContainer&&(l.observer.close(),null===(e=l.adContainer.parentNode)||void 0===e||e.removeChild(l.adContainer),l.adDiv=void 0,l.adContainer=void 0,null!=l.refreshTimeout&&(window.clearTimeout(l.refreshTimeout),l.refreshTimeout=void 0))},this.refreshAdvert=function(){l.adContainer&&window.apntag.refresh([l.id])},this.autoRefresh=function(){l.refreshCounter++,l.refreshTimeout=void 0,l.refreshAdvert()};var f=this.closeBtn?this.close:void 0,v=this.refresh&&"enabled"==(null===(u=this.refreshSettings)||void 0===u?void 0:u.btnClick)?this.refreshAdvert:void 0,p=this.refresh&&(null===(c=this.refreshSettings)||void 0===c?void 0:c.delay)&&(null===(h=this.refreshSettings)||void 0===h?void 0:h.repeat)?this.autoRefresh:void 0;this.observer=new n.AdvertObserver(this,f,v,p)}return e.prototype.renderToDom=function(){var e=this,t="container-for-"+this.id,r=document.getElementById(t);r||((r=document.createElement("div")).classList.add("advert_container"),r.classList.add("advert_container_"+this.position),r.style.display="none",document.body.prepend(r)),this.adContainer=r,this.adDiv=document.createElement("div"),this.adDiv.id=this.id,this.adDiv.classList.add("advert_display"),this.adDiv.classList.add("advert_display_"+this.position),this.adContainer.appendChild(this.adDiv),this.observer.observe(),window.apntag.anq.push((function(){window.apntag.showTag(e.id)}))},e.prototype.toAdUnit=function(){return{code:this.id,mediaTypes:{banner:{sizes:this.sizes.map((function(e){return[e.width,e.height]}))}},bids:this.bids}},e.prototype.toApnTag=function(){return{tagId:this.unit,sizes:this.sizes.map((function(e){return[e.width,e.height]})),targetId:this.id}},e}();t.Advert=i},961:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AdvertFactory=void 0;var n=r(548),i=function(){function e(){var e=this;this.fromData=function(t){if(!(t&&t.unit&&t.id&&t.sizes&&Array.isArray(t.sizes)&&t.bids&&Array.isArray(t.bids)))throw new Error("Invalid advert data");return new n.Advert(t.unit.toString(),t.id.toString(),e.toSizeArray(t.sizes),e.toBidArray(t.bids),!!t.refresh,e.toPosition(t.position||t.positon),!!t.closeBtn,e.toRefreshSettingsObject(t.refreshSettings))}}return e.prototype.toSizeArray=function(e){var t=[];return e.forEach((function(e){if(!Array.isArray(e)||2!=e.length)throw new Error("Invalid advert size data");var r={width:e[0],height:e[1]};t.push(r)})),t},e.prototype.toBidArray=function(e){var t=[];return e.forEach((function(e){var r;if(!e.bidder||!(null===(r=e.params)||void 0===r?void 0:r.placementId))throw new Error("Invalid advert bidder data");var n={bidder:e.bidder,params:{placementId:e.params.placementId}};t.push(n)})),t},e.prototype.toPosition=function(e){return~["left","right","bottom"].indexOf(e)?e:"bottom"},e.prototype.toRefreshSettingsObject=function(e){if(e)return e.delay||e.repeat?{delay:e.delay||0,repeat:e.repeat||0,btnClick:"disabled"}:e.btnClick&&"enabled"==e.btnClick?{delay:0,repeat:0,btnClick:"enabled"}:void 0},e}();t.AdvertFactory=i},239:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AdvertObserver=void 0;var r=function(){function e(e,t,r,n){var i=this;this.advert=e,this.closeFunc=t,this.refreshButtonFunc=r,this.autoRefreshFunc=n,this.advertChanged=function(e){i.advert.adDiv&&!i.changeIsNotRefresh(e)&&(i.closeFunc&&i.addCloseButton(),i.refreshButtonFunc&&i.addRefreshButton(),i.autoRefreshFunc&&i.advert.refreshSettings&&i.initiateAutoRefresh())},this.observer=new MutationObserver(this.advertChanged),this.closeButtonId="advert_close_button_"+this.advert.id,this.refreshButtonId="advert_refresh_button_"+this.advert.id}return e.prototype.observe=function(){var e;(null===(e=null==this?void 0:this.advert)||void 0===e?void 0:e.adDiv)&&this.observer.observe(this.advert.adDiv,{childList:!0})},e.prototype.close=function(){this.observer.disconnect()},e.prototype.addCloseButton=function(){var e=document.getElementById("advert_close_button_"+this.advert.id);e||((e=document.createElement("span")).id=this.closeButtonId,e.classList.add("advert_close_button"),e.innerHTML="X",e.addEventListener("click",this.closeFunc),this.advert.adDiv.prepend(e))},e.prototype.addRefreshButton=function(){var e=document.getElementById("advert_refresh_button_"+this.advert.id);e||((e=document.createElement("span")).id=this.refreshButtonId,e.classList.add("advert_refresh_button"),e.innerHTML="Refresh AD",e.addEventListener("click",this.refreshButtonFunc),this.advert.adDiv.prepend(e))},e.prototype.initiateAutoRefresh=function(){null!=this.advert.refreshTimeout&&(window.clearTimeout(this.advert.refreshTimeout),this.advert.refreshTimeout=void 0),this.advert.refreshCounter<this.advert.refreshSettings.repeat&&(this.advert.refreshTimeout=window.setTimeout(this.autoRefreshFunc,this.advert.refreshSettings.delay))},e.prototype.changeIsNotRefresh=function(e){var t=this;return e.map((function(e){if(!e.addedNodes.length)return!0;for(var r=0;r<e.addedNodes.length;r++){var n=e.addedNodes[r];if(!(n instanceof HTMLElement&&~[t.closeButtonId,t.refreshButtonId].indexOf(n.id)))return!1}return!0})).reduce((function(e,t){return e&&t}),!0)},e}();t.AdvertObserver=r},963:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AdvertService=void 0;t.AdvertService=function(e){var t=this;this.global=e,this.requestBids=function(e){t.global.pbjs.que.push((function(){t.global.pbjs.addAdUnits(e),t.global.pbjs.requestBids({bidsBackHandler:t.initAdServer,timeout:1e3})}))},this.initAdServer=function(){t.global.pbjs.requestSent||(t.global.pbjs.requestSent=!0,t.global.pbjs.que.push((function(){t.global.apntag.anq.push((function(){t.global.pbjs.setTargetingForAst(),t.global.apntag.loadTags()}))})))},this.setPageOptions=function(e){t.global.apntag.anq.push((function(){t.global.apntag.setPageOpts({member:1543}),e.map((function(e){return e.toApnTag()})).forEach((function(e){return t.global.apntag.defineTag(e)}))}))}}},629:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Comms=void 0;var o=r(961),s=function(){function e(){}return e.prototype.fetchAdvertsFromAPI=function(){return n(this,void 0,void 0,(function(){var e,t,r,n;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,fetch("https://60bcfd7fb8ab3700175a005b.mockapi.io/eg/ads")];case 1:if(!(e=i.sent()).ok)throw new Error("Response from the API failed with "+e.status+" "+e.statusText);return[4,e.json()];case 2:if(t=i.sent(),!Array.isArray(t))throw new Error("Data is not an array");return r=new o.AdvertFactory,[2,t.map(r.fromData)];case 3:return n=i.sent(),console.log("Failed to download data from the API. Errors will be swallowed so as not to interupt users' experience"),console.error(n),[3,4];case 4:return[2,[]]}}))}))},e}();t.Comms=s},607:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(629),s=r(963);!function(e){n(this,void 0,void 0,(function(){var t,r,n,a,d;return i(this,(function(i){switch(i.label){case 0:return[4,(new o.Comms).fetchAdvertsFromAPI()];case 1:return(t=i.sent()).forEach((function(e){return e.renderToDom()})),r=t.map((function(e){return e.toAdUnit()})),n=new s.AdvertService(e),(a=e.pbjs||{}).que=a.que||[],(d=e.apntag||{}).anq=d.anq||[],n.requestBids(r),n.setPageOptions(t),[2]}}))}))}(window)}},t={};!function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(607)})();
//# sourceMappingURL=advert.js.map