{"version":3,"sources":["webpack://prebid-example/./src/advert.ts","webpack://prebid-example/./src/advertFactory.ts","webpack://prebid-example/./src/advertObserver.ts","webpack://prebid-example/./src/advertService.ts","webpack://prebid-example/./src/comms.ts","webpack://prebid-example/./src/index.ts","webpack://prebid-example/webpack/bootstrap","webpack://prebid-example/webpack/startup"],"names":[],"mappings":"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","file":"advert.js","sourcesContent":["import * as apntag from \"./appNexus\";\r\nimport { AdvertObserver } from \"./advertObserver\";\r\n\r\nexport class Advert {\r\n  constructor(\r\n    public unit: string,\r\n    public id: string,\r\n    public sizes: IAdvertSize[],\r\n    public bids: IAdvertBidder[],\r\n    public refresh: boolean = false,\r\n    public position: ValidPosition = \"bottom\",\r\n    public closeBtn: boolean = false,\r\n    public refreshSettings?: IAdvertRefreshSettings\r\n  ) {\r\n    let closeFunc = this.closeBtn ? this.close : undefined;\r\n    let refreshFunc =\r\n      this.refresh && this.refreshSettings?.btnClick == \"enabled\"\r\n        ? this.refreshAdvert\r\n        : undefined;\r\n    let autoRefreshFunc =\r\n      this.refresh &&\r\n      this.refreshSettings?.delay &&\r\n      this.refreshSettings?.repeat\r\n        ? this.autoRefresh\r\n        : undefined;\r\n    this.observer = new AdvertObserver(\r\n      this,\r\n      closeFunc,\r\n      refreshFunc,\r\n      autoRefreshFunc\r\n    );\r\n  }\r\n\r\n  public adDiv?: HTMLDivElement;\r\n  public adContainer?: HTMLDivElement;\r\n  public refreshTimeout?: number;\r\n  public refreshCounter: number = 0;\r\n\r\n  private observer: AdvertObserver;\r\n\r\n  public renderToDom(): void {\r\n    this.adContainer = document.createElement(\"div\");\r\n    this.adContainer.classList.add(\"advert_container\");\r\n    this.adContainer.classList.add(`advert_container_${this.position}`);\r\n    this.adContainer.style.display = \"none\";\r\n    this.adDiv = document.createElement(\"div\");\r\n    this.adDiv.id = this.id;\r\n    this.adDiv.classList.add(\"advert_display\");\r\n    this.adDiv.classList.add(`advert_display_${this.position}`);\r\n    this.adContainer.appendChild(this.adDiv);\r\n    document.body.prepend(this.adContainer);\r\n    this.observer.observe();\r\n\r\n    window.apntag.anq.push(() => {\r\n      window.apntag.showTag(this.id);\r\n    });\r\n  }\r\n\r\n  public toAdUnit(): IAdUnit {\r\n    return {\r\n      code: this.id,\r\n      mediaTypes: {\r\n        banner: {\r\n          sizes: this.sizes.map((size) => [size.width, size.height]),\r\n        },\r\n      },\r\n      bids: this.bids,\r\n    };\r\n  }\r\n\r\n  public toApnTag(): IApnTag {\r\n    return {\r\n      tagId: this.unit,\r\n      sizes: this.sizes.map((size) => [size.width, size.height]),\r\n      targetId: this.id,\r\n    };\r\n  }\r\n\r\n  public close = (): void => {\r\n    if (!this.adContainer) return;\r\n    this.adContainer.parentNode?.removeChild(this.adContainer);\r\n    this.adDiv = undefined;\r\n    this.adContainer = undefined;\r\n    if (this.refreshTimeout != undefined) {\r\n      window.clearTimeout(this.refreshTimeout);\r\n      this.refreshTimeout = undefined;\r\n    }\r\n  };\r\n\r\n  public refreshAdvert = (): void => {\r\n    if (!this.adContainer) return;\r\n    window.apntag.refresh([this.id]);\r\n  };\r\n\r\n  private autoRefresh = (): void => {\r\n    this.refreshCounter++;\r\n    this.refreshTimeout = undefined;\r\n    this.refreshAdvert();\r\n  };\r\n}\r\n\r\nexport type ValidPosition = \"left\" | \"right\" | \"bottom\";\r\n\r\nexport interface IAdvertSize {\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nexport interface IAdvertRefreshSettings {\r\n  delay: number;\r\n  repeat: number;\r\n  btnClick: \"enabled\" | \"disabled\";\r\n}\r\n\r\nexport interface IAdvertBidder {\r\n  bidder: string;\r\n  params: {\r\n    placementId: number;\r\n  };\r\n}\r\n\r\nexport interface IAdUnit {\r\n  code: string;\r\n  mediaTypes: {\r\n    banner: {\r\n      sizes: number[][];\r\n    };\r\n  };\r\n  bids: IAdvertBidder[];\r\n}\r\n\r\nexport interface IApnTag {\r\n  tagId: string;\r\n  sizes: number[][];\r\n  targetId: string;\r\n}\r\n","import {\r\n  Advert,\r\n  ValidPosition,\r\n  IAdvertSize,\r\n  IAdvertRefreshSettings,\r\n  IAdvertBidder,\r\n} from \"./advert\";\r\n\r\nexport class AdvertFactory {\r\n  /**\r\n   * Construct a new Advert from a data object\r\n   * We know the object has come from an external source, so we need to be very careful about constructing the Advert,\r\n   * so we can trust the structure inside our system\r\n   * The method is created as a function property to ensure binding with the class,\r\n   * to allow it to be easily used in a map function.\r\n   */\r\n  public fromData = (element: any): Advert => {\r\n    if (\r\n      !element ||\r\n      !element.unit ||\r\n      !element.id ||\r\n      !element.sizes ||\r\n      !Array.isArray(element.sizes) ||\r\n      !element.bids ||\r\n      !Array.isArray(element.bids)\r\n    )\r\n      throw new Error(\"Invalid advert data\");\r\n    return new Advert(\r\n      element.unit.toString(),\r\n      element.id.toString(),\r\n      this.toSizeArray(element.sizes),\r\n      this.toBidArray(element.bids),\r\n      !!element.refresh,\r\n      this.toPosition(element.position || element.positon), // Note - the API spells this incorrectly.\r\n      !!element.closeBtn,\r\n      this.toRefreshSettingsObject(element.refreshSettings)\r\n    );\r\n  };\r\n\r\n  private toSizeArray(sizes: any[]): IAdvertSize[] {\r\n    var result: IAdvertSize[] = [];\r\n    sizes.forEach((element) => {\r\n      if (!Array.isArray(element) || element.length != 2)\r\n        throw new Error(\"Invalid advert size data\");\r\n      var size: IAdvertSize = {\r\n        width: element[0],\r\n        height: element[1],\r\n      };\r\n      result.push(size);\r\n    });\r\n    return result;\r\n  }\r\n\r\n  private toBidArray(bids: any[]): IAdvertBidder[] {\r\n    var result: IAdvertBidder[] = [];\r\n    bids.forEach((element) => {\r\n      if (!element.bidder || !element.params?.placementId)\r\n        throw new Error(\"Invalid advert bidder data\");\r\n      var bidder: IAdvertBidder = {\r\n        bidder: element.bidder,\r\n        params: {\r\n          placementId: element.params.placementId,\r\n        },\r\n      };\r\n      result.push(bidder);\r\n    });\r\n    return result;\r\n  }\r\n\r\n  private toPosition(position: string): ValidPosition {\r\n    if (~[\"left\", \"right\", \"bottom\"].indexOf(position)) {\r\n      return position as ValidPosition;\r\n    }\r\n\r\n    return \"bottom\";\r\n  }\r\n\r\n  private toRefreshSettingsObject(\r\n    settings: any\r\n  ): IAdvertRefreshSettings | undefined {\r\n    if (!settings) return undefined;\r\n    if (settings.delay || settings.repeat) {\r\n      return {\r\n        delay: settings.delay || 0,\r\n        repeat: settings.repeat || 0,\r\n        btnClick: \"disabled\",\r\n      };\r\n    }\r\n    if (settings.btnClick && settings.btnClick == \"enabled\")\r\n      return { delay: 0, repeat: 0, btnClick: \"enabled\" };\r\n    return undefined;\r\n  }\r\n}\r\n","import { Advert } from \"./advert\";\r\n\r\nexport class AdvertObserver {\r\n  private observer: MutationObserver;\r\n  private closeButtonId: string;\r\n  private refreshButtonId: string;\r\n\r\n  constructor(\r\n    private advert: Advert,\r\n    private closeFunc?: () => void,\r\n    private refreshButtonFunc?: () => void,\r\n    private autoRefreshFunc?: () => void\r\n  ) {\r\n    this.observer = new MutationObserver(this.advertChanged);\r\n    this.closeButtonId = `advert_close_button_${this.advert.id}`;\r\n    this.refreshButtonId = `advert_refresh_button_${this.advert.id}`;\r\n  }\r\n\r\n  public observe() {\r\n    if (!this?.advert?.adDiv) return;\r\n    this.observer.observe(this.advert.adDiv, { childList: true });\r\n  }\r\n\r\n  private advertChanged = (events: MutationRecord[]): void => {\r\n    if (!this.advert.adDiv || this.changeIsNotRefresh(events)) return;\r\n\r\n    if (this.closeFunc) {\r\n      this.addCloseButton();\r\n    }\r\n\r\n    if (this.refreshButtonFunc) {\r\n      this.addRefreshButton();\r\n    }\r\n\r\n    if (this.autoRefreshFunc && this.advert.refreshSettings) {\r\n      this.initiateAutoRefresh();\r\n    }\r\n  };\r\n\r\n  private initiateAutoRefresh() {\r\n    if (this.advert.refreshTimeout != undefined) {\r\n      window.clearTimeout(this.advert.refreshTimeout);\r\n    }\r\n    if (this.advert.refreshCounter < this.advert.refreshSettings!.repeat) {\r\n      this.advert.refreshTimeout = window.setTimeout(\r\n        this.autoRefreshFunc!,\r\n        this.advert.refreshSettings!.delay\r\n      );\r\n    }\r\n  }\r\n\r\n  private addRefreshButton() {\r\n    let refreshButton = document.getElementById(\r\n      `advert_refresh_button_${this.advert.id}`\r\n    );\r\n    if (!refreshButton) {\r\n      refreshButton = document.createElement(\"span\");\r\n      refreshButton.id = this.refreshButtonId;\r\n      refreshButton.classList.add(\"advert_refresh_button\");\r\n      refreshButton.innerHTML = \"Refresh AD\";\r\n      refreshButton.addEventListener(\"click\", this.refreshButtonFunc!);\r\n      this.advert.adDiv!.prepend(refreshButton);\r\n    }\r\n  }\r\n\r\n  private addCloseButton() {\r\n    let closeButton = document.getElementById(\r\n      `advert_close_button_${this.advert.id}`\r\n    );\r\n    if (!closeButton) {\r\n      closeButton = document.createElement(\"span\");\r\n      closeButton.id = this.closeButtonId;\r\n      closeButton.classList.add(\"advert_close_button\");\r\n      closeButton.innerHTML = \"X\";\r\n      closeButton.addEventListener(\"click\", this.closeFunc!);\r\n      this.advert.adDiv!.prepend(closeButton);\r\n    }\r\n  }\r\n\r\n  private changeIsNotRefresh(events: MutationRecord[]): boolean {\r\n    return events\r\n      .map((event) => {\r\n        // We are only interested in changes that add new nodes\r\n        if (!event.addedNodes.length) {\r\n          return true;\r\n        }\r\n\r\n        // Look through the list of added nodes for any that aren't the two we control\r\n        for (let index = 0; index < event.addedNodes.length; index++) {\r\n          const element = event.addedNodes[index];\r\n          if (\r\n            !(element instanceof HTMLElement) ||\r\n            !~[this.closeButtonId, this.refreshButtonId].indexOf(\r\n              (element as HTMLElement).id\r\n            )\r\n          ) {\r\n            return false;\r\n          }\r\n        }\r\n\r\n        // We didn't find any that we don't control, so this event is all us - this is not a refresh\r\n        return true;\r\n      })\r\n      .reduce((check, current) => check && current, true);\r\n  }\r\n}\r\n","import * as pbjs from \"./prebid\";\r\nimport * as apntag from \"./appNexus\";\r\nimport { IAdUnit, Advert } from \"./advert\";\r\n\r\nconst PrebidTimeout = 1000;\r\n\r\nexport class AdvertService {\r\n  constructor(private global: any) {}\r\n\r\n  public requestBids = (adUnits: IAdUnit[]) => {\r\n    this.global.pbjs.que.push(() => {\r\n      this.global.pbjs.addAdUnits(adUnits);\r\n      this.global.pbjs.requestBids({\r\n        bidsBackHandler: this.initAdServer,\r\n        timeout: PrebidTimeout,\r\n      });\r\n    });\r\n  };\r\n\r\n  public initAdServer = () => {\r\n    if (this.global.pbjs.requestSent) {\r\n      return;\r\n    }\r\n    this.global.pbjs.requestSent = true;\r\n    this.global.pbjs.que.push(() => {\r\n      this.global.apntag.anq.push(() => {\r\n        this.global.pbjs.setTargetingForAst();\r\n        this.global.apntag.loadTags();\r\n      });\r\n    });\r\n  };\r\n\r\n  public setPageOptions = (adverts: Advert[]) => {\r\n    this.global.apntag.anq.push(() => {\r\n      this.global.apntag.setPageOpts({\r\n        member: 1543,\r\n      });\r\n      adverts\r\n        .map((advert) => advert.toApnTag())\r\n        .forEach((tag) => this.global.apntag.defineTag(tag));\r\n    });\r\n  };\r\n}\r\n","import { Advert } from \"./advert\";\r\nimport { AdvertFactory } from \"./advertFactory\";\r\n\r\nconst APIURL = \"https://60bcfd7fb8ab3700175a005b.mockapi.io/eg/ads\";\r\n\r\nexport class Comms {\r\n  public async fetchAdvertsFromAPI(): Promise<Advert[]> {\r\n    try {\r\n      let response = await fetch(APIURL);\r\n      if (!response.ok) {\r\n        throw new Error(\r\n          `Response from the API failed with ${response.status} ${response.statusText}`\r\n        );\r\n      }\r\n\r\n      let data = await response.json();\r\n      if (!Array.isArray(data)) {\r\n        throw new Error(\"Data is not an array\");\r\n      }\r\n\r\n      var factory = new AdvertFactory();\r\n      var result: Advert[] = (data as Array<any>).map(factory.fromData);\r\n      return result;\r\n    } catch (err) {\r\n      console.log(\r\n        \"Failed to download data from the API. Errors will be swallowed so as not to interupt users' experience\"\r\n      );\r\n      console.error(err);\r\n    }\r\n\r\n    return [];\r\n  }\r\n}\r\n","import { Comms } from \"./comms\";\r\nimport * as pbjs from \"./prebid\";\r\nimport * as apntag from \"./appNexus\";\r\nimport { AdvertService } from \"./advertService\";\r\n\r\n(async function (global) {\r\n  let comms = new Comms();\r\n  let adverts = await comms.fetchAdvertsFromAPI();\r\n  adverts.forEach((advert) => advert.renderToDom());\r\n  let adUnits = adverts.map((advert) => advert.toAdUnit());\r\n  let service = new AdvertService(global);\r\n\r\n  let pbjs = global.pbjs || {};\r\n  pbjs.que = pbjs.que || [];\r\n\r\n  let apntag = global.apntag || {};\r\n  apntag.anq = apntag.anq || [];\r\n\r\n  service.requestBids(adUnits);\r\n  service.setPageOptions(adverts);\r\n})(window);\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/index.ts\");\n"],"sourceRoot":""}